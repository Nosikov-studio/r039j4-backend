# r039j4-backend
Учебный проект j4 по мотивам занятия на тему библиотеки passport.js
Для простоты в этом примере мы не используем базу данных, 
вместо неё используется экземпляр объекта пользователя в памяти. 

https://www.youtube.com/watch?v=LDnwNtWIq_4


Статьи

https://habr.com/ru/articles/201206/

Простое объяснение как работает passport.js тут:
https://www.reddit.com/r/node/comments/rk3o1g/can_anyone_help_me_understand_how_to_use/?tl=ru

https://vectree.ru/text/101/0/0

https://bsa-git.github.io/portfolio/node/express-passport/


*****
Каждая стратегия имеет свои особенности конфигурирования. Неизменным остается только то, что в конструктор стратегии передается callback-функция, которая формирует объект user, доступный как request.user для следующих в очереди middleware:

*****
*****
LocalStrategy принимает 2 параметра: объект с опциями и middleware для верификации пользователя.
По-умолчанию, если в `LocalStrategy` не передавать никаких опций — стратегия будет искать параметры для авторизации пользователя в формах с именами `username` и `password`. При желании, можно указать свои имена форм, как я, собственно, и сделал.
Второй аргумент — middleware — принимает параметры `username`, `passport` и `done`. В done, вторым аргументом, передаем объект пользователя, если такой есть.
*****
*****
Для того, чтобы сохранять или доставать пользовательские данные из сессии, паспорт использует функции `passport.serializeUser()` и `passport.deserializeUser()`.

Сериализация и десериализация работает только со стратегиями, для которых задан атрибут {session: true}. Сериализация будет выполнена ровно один раз сразу после аутентификации. Поэтому обновить данные сохраненные в сессии будет весьма проблематично, в связи с чем сохраняется только идентификатор пользователя (который не меняется). Десериализация будет выполняться при каждом запросе к защищенному роуту. В связи с чем запросы к базе данных (как в примере) существенно влияют на производительность приложения.

*****
